.. _kotlin-whats-new:

==========
What's New
==========

.. contents:: On this page
   :local:
   :backlinks: none
   :depth: 1
   :class: singlecol

Learn what's new in:

* :ref:`Version 4.10 <version-4.10>`

.. _upcoming-breaking-changes:

Upcoming Breaking Changes
-------------------------

- Beginning with v5.0, the Kotlin Driver requires Java 11 or later.
- Beginning with v5.0, several Stream API methods and classes will be
  removed. To learn which methods will be removed, see :ref:`version-4.11`.

.. _version-4.11:

What's New in 4.11
------------------

.. important:: Deprecation Notice

   - The ``getStats()`` and ``isCapped()`` instance methods of the
     ``DBCollection`` class are deprecated. The corresponding server
     commands are deprecated in MongoDB v6.2 and later. Use the ``$collStats`` aggregation
     pipeline stage to retrieve the information provided by these methods
     instead.

     To learn more about the ``$collStats`` aggregation operator, see the
     :manual:`$collStats (aggregation) </reference/operator/aggregation/collStats/>`
     Server manual entry.

   - The following Stream API methods and classes are deprecated are scheduled
     for removal in v5.0:

     - ``streamFactoryFactory()`` method from ``MongoClientSettings.Builder``
     - ``getStreamFactoryFactory()`` method from ``MongoClientSettings``
     - ``NettyStreamFactoryFactory`` class
     - ``NettyStreamFactory`` class
     - ``AsynchronousSocketChannelStreamFactory`` class
     - ``AsynchronousSocketChannelStreamFactoryFactory`` class
     - ``BufferProvider`` class
     - ``SocketStreamFactory`` class
     - ``Stream`` class
     - ``StreamFactory`` class
     - ``StreamFactoryFactory`` class
     - ``TlsChannelStreamFactoryFactory`` class

.. note:: Upgraded Netty Version

   The {+driver-short+} now tests with version 4.1.87.Final of the
   ``io.netty:netty-all`` package. This change affects you only if you use the
   ``SslContext`` class that Netty provides.

New features of the 4.11 driver release include:

- Support for connecting to MongoDB by using a SOCKS5 proxy. TODO: needs a ticket for content
- Added a class to manage Client-Side Operations Timeout (CSOT) options. TODO: needs a ticket for content
- Added the ``getSplitEvent()`` method to the ``ChangeStreamDocument`` class
  to identify fragments of a change stream event that exceeds 16MB. You must
  use the aggregation stage ``$changeStreamSplitLargeEvent`` in your change
  stream to handle change stream events that exceed 16MB.
- Added an aggregation stage builder for ``$vectorSearch``. TODO: needs a ticket for content
- Added search index management helpers. TODO: needs a ticket for content
- Updated Snappy and Zstd compression library dependency versions. To learn
  more about the current dependency versions, see :ref:`network-compression`.
- Added the following classes and ``getElapsedTime()`` methods to them to
  monitor the duration of connection pool events:

  - TODO: link to API driver-core docs for these (DOCSP-31914)
  - ``ConnectionCheckOutFailedEvent``
  - ``ConnectionCheckedOutEvent``
  - ``ConnectionReadyEvent``


.. _version-4.10:

What's New in 4.10
------------------

.. important::

   Starting in version 4.10.1 of the {+driver-short+}, you must add
   the ``bson-kotlinx`` library as an explicit dependency to use the 
   ``kotlinx-serialization`` library.

- Support for Kotlin server-side usage, both for coroutines and for synchronous applications.
- Codec support for Kotlin data classes.
- Support for the ``kotlinx.serialization`` library
